## AIDevelo.ai – AI agent guide

- **Architecture**: Frontend React 19 + Vite (`src/App.tsx`) with router pages and Tailwind/Framer Motion; backend Express/TypeScript (`server/src/app.ts`) exposing REST + Swagger, Socket/WebSocket for voice agent, background jobs. Voice agent domain lives under `server/src/voice-agent` (RAG, LLM provider abstraction, tools, WebSocket audio pipeline).
- **Environments**: Frontend uses `VITE_API_URL` (default `http://localhost:5000/api`) set in `.env.local`. Backend reads `server/.env` (see `server/src/config/env.ts`); `NODE_ENV` defaults to `development`; `ELEVENLABS_API_KEY` warned if missing; `ALLOWED_ORIGINS` comma list; `PORT` default 5000.
- **Frontend commands** (root): dev `npm run dev`; build `npm run build`; preview `npm run preview`; tests `npm run test` / `test:watch` / `test:coverage`. Workflow CLI scripts run via `npm run workflow:*` (uses `workflows/cli/cli.ts`).
- **Backend commands** (`cd server`): dev `npm run dev` (nodemon); build `npm run build` (tsc); start `npm start`; swagger JSON `npm run docs:generate`; sample TTS check `npm run test:elevenlabs`. Swagger UI served at `/api-docs` when running.
- **Frontend data flow**: Components call `apiRequest` (`src/services/api.ts`) which centralizes base URL resolution, JSON parsing, and throws `ApiRequestError` with helpful network messaging; set `VITE_DEBUG_API=true` to log requests in dev. Voice webchat hook `useVoiceAgentChat` posts to `/voice-agent/query`, appends optimistic user message, and renders assistant reply with optional tool calls.
- **Backend voice agent flow**: `server/src/voice-agent/routes/voiceAgentRoutes.ts` exposes `/api/voice-agent/query` (RAG → prompt context → LLM → optional tool calls), `/ingest`, `/session`, `/call-session`. WebSocket endpoint `/api/voice-agent/call-session` spins up `VoicePipelineHandler` for real-time audio (ASR→LLM→TTS) and greets with company name; sessions tracked in `sessionStore`.
- **RAG & tools**: RAG services under `server/src/voice-agent/rag` (vector store/Qdrant client, ingest/query, prompt templates). Tooling registry (`tools/toolRegistry.ts`) wraps calendar/CRM/notification tools; tool definitions fed into LLM request and executed post-response.
- **API composition**: App mounts routes for agents, ElevenLabs, payments, purchases, voice, telephony, sync, enterprise, calendar, onboarding, and voice-agent. Rate limiting applied to `/api/*` via `express-rate-limit`; CORS uses `config.allowedOrigins` and logs rejected origins. Static frontend served only when `NODE_ENV=production`.
- **Workflows package**: `workflows/` contains orchestrator with JSON workflow definitions and CLI (`npm run workflow:run workflows/definitions/ci-cd-workflow.json`, etc.) supporting env flag overrides; good place to automate CI/CD or scheduled tasks.
- **Testing & troubleshooting**: For quick backend sanity, curl `POST /api/voice-agent/query` or `/ingest` as shown in `server/src/voice-agent/README.md`. If frontend cannot reach API, verify backend on port 5000 and `VITE_API_URL` matches; check CORS allowed origins and rate limiter (100 req / 15 min window) when debugging 429/403.
- **Styling & UX**: Tailwind config in `tailwind.config.cjs`; theme colors `background/primary/accent` with Inter + Space Grotesk. Page components live in `src/pages/*`, shared sections in `src/components/*`; animations via Framer Motion; 3D avatar components use React Three Fiber.
- **Deployment notes**: Frontend Cloudflare Pages script `npm run deploy:cf` expects `CF_PAGES_PROJECT_NAME` and prior build. Docker instructions in `DOCKER.md`; backend Dockerfile in `server/`.
- **Conventions**: Keep React imports via `@` alias; avoid exposing API keys in client—Vite config enforces backend proxy expectation. Use provided types in `src/types.ts` and `server/src/models/types` to keep client/server aligned. Prefer adding new API routes under `server/src/routes` and register in `app.ts`; mirror client calls via `apiRequest` for consistent error handling.

Ask for clarification if a workflow or integration point is unclear, otherwise proceed with the patterns above.